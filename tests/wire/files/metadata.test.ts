/**
 * This file was auto-generated by Fern from our API Definition.
 */

import { mockServerPool } from "../../mock-server/MockServerPool";
import { ImageKitClient } from "../../../src/Client";

describe("Metadata", () => {
    test("get", async () => {
        const server = mockServerPool.createServer();
        const client = new ImageKitClient({ username: "test", password: "test", environment: server.baseUrl });

        const rawResponseBody = {
            height: 68,
            width: 100,
            size: 7749,
            format: "jpg",
            hasColorProfile: true,
            quality: 0,
            density: 72,
            hasTransparency: false,
            pHash: "f06830ca9f1e3e90",
            bitRate: 1,
            duration: 1,
            audioCodec: "audioCodec",
            videoCodec: "videoCodec",
            exif: {
                image: {
                    Make: "Canon",
                    Model: "Canon EOS 40D",
                    Orientation: 1,
                    XResolution: 72,
                    YResolution: 72,
                    ResolutionUnit: 2,
                    Software: "GIMP 2.4.5",
                    ModifyDate: "2008:07:31 10:38:11",
                    YCbCrPositioning: 2,
                    ExifOffset: 214,
                    GPSInfo: 978,
                },
                thumbnail: {
                    Compression: 6,
                    XResolution: 72,
                    YResolution: 72,
                    ResolutionUnit: 2,
                    ThumbnailOffset: 1090,
                    ThumbnailLength: 1378,
                },
                exif: {
                    ExposureTime: 0.00625,
                    FNumber: 7.1,
                    ExposureProgram: 1,
                    ISO: 100,
                    ExifVersion: "0221",
                    DateTimeOriginal: "2008:05:30 15:56:01",
                    CreateDate: "2008:05:30 15:56:01",
                    ShutterSpeedValue: 7.375,
                    ApertureValue: 5.625,
                    ExposureCompensation: 0,
                    MeteringMode: 5,
                    Flash: 9,
                    FocalLength: 135,
                    SubSecTime: "00",
                    FlashpixVersion: "0100",
                    ColorSpace: 1,
                    ExifImageWidth: 100,
                    ExifImageHeight: 68,
                    InteropOffset: 948,
                    FocalPlaneXResolution: 4438.356164383562,
                    FocalPlaneYResolution: 4445.969125214408,
                    FocalPlaneResolutionUnit: 2,
                    CustomRendered: 0,
                    ExposureMode: 1,
                    WhiteBalance: 0,
                    SceneCaptureType: 0,
                },
                gps: { GPSVersionID: [2, 2, 0, 0] },
                interoperability: { InteropIndex: "R98", InteropVersion: "0100" },
                makernote: { key: "value" },
            },
        };
        server
            .mockEndpoint()
            .get("/v1/files/fileId/metadata")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.files.metadata.get("fileId");
        expect(response).toEqual({
            height: 68,
            width: 100,
            size: 7749,
            format: "jpg",
            hasColorProfile: true,
            quality: 0,
            density: 72,
            hasTransparency: false,
            pHash: "f06830ca9f1e3e90",
            bitRate: 1,
            duration: 1,
            audioCodec: "audioCodec",
            videoCodec: "videoCodec",
            exif: {
                image: {
                    Make: "Canon",
                    Model: "Canon EOS 40D",
                    Orientation: 1,
                    XResolution: 72,
                    YResolution: 72,
                    ResolutionUnit: 2,
                    Software: "GIMP 2.4.5",
                    ModifyDate: "2008:07:31 10:38:11",
                    YCbCrPositioning: 2,
                    ExifOffset: 214,
                    GPSInfo: 978,
                },
                thumbnail: {
                    Compression: 6,
                    XResolution: 72,
                    YResolution: 72,
                    ResolutionUnit: 2,
                    ThumbnailOffset: 1090,
                    ThumbnailLength: 1378,
                },
                exif: {
                    ExposureTime: 0.00625,
                    FNumber: 7.1,
                    ExposureProgram: 1,
                    ISO: 100,
                    ExifVersion: "0221",
                    DateTimeOriginal: "2008:05:30 15:56:01",
                    CreateDate: "2008:05:30 15:56:01",
                    ShutterSpeedValue: 7.375,
                    ApertureValue: 5.625,
                    ExposureCompensation: 0,
                    MeteringMode: 5,
                    Flash: 9,
                    FocalLength: 135,
                    SubSecTime: "00",
                    FlashpixVersion: "0100",
                    ColorSpace: 1,
                    ExifImageWidth: 100,
                    ExifImageHeight: 68,
                    InteropOffset: 948,
                    FocalPlaneXResolution: 4438.356164383562,
                    FocalPlaneYResolution: 4445.969125214408,
                    FocalPlaneResolutionUnit: 2,
                    CustomRendered: 0,
                    ExposureMode: 1,
                    WhiteBalance: 0,
                    SceneCaptureType: 0,
                },
                gps: {
                    GPSVersionID: [2, 2, 0, 0],
                },
                interoperability: {
                    InteropIndex: "R98",
                    InteropVersion: "0100",
                },
                makernote: {
                    key: "value",
                },
            },
        });
    });

    test("getFromURL", async () => {
        const server = mockServerPool.createServer();
        const client = new ImageKitClient({ username: "test", password: "test", environment: server.baseUrl });

        const rawResponseBody = {
            height: 68,
            width: 100,
            size: 7749,
            format: "jpg",
            hasColorProfile: true,
            quality: 0,
            density: 72,
            hasTransparency: false,
            pHash: "f06830ca9f1e3e90",
            bitRate: 1,
            duration: 1,
            audioCodec: "audioCodec",
            videoCodec: "videoCodec",
            exif: {
                image: {
                    Make: "Canon",
                    Model: "Canon EOS 40D",
                    Orientation: 1,
                    XResolution: 72,
                    YResolution: 72,
                    ResolutionUnit: 2,
                    Software: "GIMP 2.4.5",
                    ModifyDate: "2008:07:31 10:38:11",
                    YCbCrPositioning: 2,
                    ExifOffset: 214,
                    GPSInfo: 978,
                },
                thumbnail: {
                    Compression: 6,
                    XResolution: 72,
                    YResolution: 72,
                    ResolutionUnit: 2,
                    ThumbnailOffset: 1090,
                    ThumbnailLength: 1378,
                },
                exif: {
                    ExposureTime: 0.00625,
                    FNumber: 7.1,
                    ExposureProgram: 1,
                    ISO: 100,
                    ExifVersion: "0221",
                    DateTimeOriginal: "2008:05:30 15:56:01",
                    CreateDate: "2008:05:30 15:56:01",
                    ShutterSpeedValue: 7.375,
                    ApertureValue: 5.625,
                    ExposureCompensation: 0,
                    MeteringMode: 5,
                    Flash: 9,
                    FocalLength: 135,
                    SubSecTime: "00",
                    FlashpixVersion: "0100",
                    ColorSpace: 1,
                    ExifImageWidth: 100,
                    ExifImageHeight: 68,
                    InteropOffset: 948,
                    FocalPlaneXResolution: 4438.356164383562,
                    FocalPlaneYResolution: 4445.969125214408,
                    FocalPlaneResolutionUnit: 2,
                    CustomRendered: 0,
                    ExposureMode: 1,
                    WhiteBalance: 0,
                    SceneCaptureType: 0,
                },
                gps: { GPSVersionID: [2, 2, 0, 0] },
                interoperability: { InteropIndex: "R98", InteropVersion: "0100" },
                makernote: { key: "value" },
            },
        };
        server.mockEndpoint().get("/v1/files/metadata").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.files.metadata.getFromUrl({
            url: "url",
        });
        expect(response).toEqual({
            height: 68,
            width: 100,
            size: 7749,
            format: "jpg",
            hasColorProfile: true,
            quality: 0,
            density: 72,
            hasTransparency: false,
            pHash: "f06830ca9f1e3e90",
            bitRate: 1,
            duration: 1,
            audioCodec: "audioCodec",
            videoCodec: "videoCodec",
            exif: {
                image: {
                    Make: "Canon",
                    Model: "Canon EOS 40D",
                    Orientation: 1,
                    XResolution: 72,
                    YResolution: 72,
                    ResolutionUnit: 2,
                    Software: "GIMP 2.4.5",
                    ModifyDate: "2008:07:31 10:38:11",
                    YCbCrPositioning: 2,
                    ExifOffset: 214,
                    GPSInfo: 978,
                },
                thumbnail: {
                    Compression: 6,
                    XResolution: 72,
                    YResolution: 72,
                    ResolutionUnit: 2,
                    ThumbnailOffset: 1090,
                    ThumbnailLength: 1378,
                },
                exif: {
                    ExposureTime: 0.00625,
                    FNumber: 7.1,
                    ExposureProgram: 1,
                    ISO: 100,
                    ExifVersion: "0221",
                    DateTimeOriginal: "2008:05:30 15:56:01",
                    CreateDate: "2008:05:30 15:56:01",
                    ShutterSpeedValue: 7.375,
                    ApertureValue: 5.625,
                    ExposureCompensation: 0,
                    MeteringMode: 5,
                    Flash: 9,
                    FocalLength: 135,
                    SubSecTime: "00",
                    FlashpixVersion: "0100",
                    ColorSpace: 1,
                    ExifImageWidth: 100,
                    ExifImageHeight: 68,
                    InteropOffset: 948,
                    FocalPlaneXResolution: 4438.356164383562,
                    FocalPlaneYResolution: 4445.969125214408,
                    FocalPlaneResolutionUnit: 2,
                    CustomRendered: 0,
                    ExposureMode: 1,
                    WhiteBalance: 0,
                    SceneCaptureType: 0,
                },
                gps: {
                    GPSVersionID: [2, 2, 0, 0],
                },
                interoperability: {
                    InteropIndex: "R98",
                    InteropVersion: "0100",
                },
                makernote: {
                    key: "value",
                },
            },
        });
    });
});
